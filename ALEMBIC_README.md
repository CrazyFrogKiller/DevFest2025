# ‚úÖ ALEMBIC SETUP ‚Äî FINAL README

## üéâ –°—Ç–∞—Ç—É—Å –ø—Ä–æ–µ–∫—Ç–∞

**–í—Å–µ –≥–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é Alembic –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ.**
–ü–æ–ª–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –º–æ–¥–µ–ª–µ–π, –º–∏–≥—Ä–∞—Ü–∏–π –∏ PostgreSQL —É—Å–ø–µ—à–Ω–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞.

### –ò—Ç–æ–≥:

- **Alembic Setup:** ‚úÖ COMPLETE
- **Database Sync:** ‚úÖ COMPLETE
- **Models Updated:** ‚úÖ COMPLETE
- **Migration Applied:** ‚úÖ COMPLETE
- **Verification:** ‚úÖ PASSED
- **Status:** **READY FOR PRODUCTION** üöÄ

–î–∞—Ç–∞: **2025-12-08**
PostgreSQL: **18.1**
pgvector: **0.8.1**
Alembic Version: **001_initial**

---

## üß© –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ

### üü• –ü—Ä–æ–±–ª–µ–º–∞

Alembic –Ω–µ —Ä–∞–±–æ—Ç–∞–ª:

```
‚ùå alembic: –∏–º—è "alembic" –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ
‚ùå error: unrecognized subcommand 'alembic'
```

–ú–æ–¥–µ–ª–∏ –Ω–µ –±—ã–ª–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω—ã —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –ë–î.

---

## üü© –†–µ—à–µ–Ω–∏–µ

–Ø –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–æ–¥–≥–æ—Ç–æ–≤–∏–ª Alembic –ø–æ–¥ –≤–∞—à—É RAG-—Å–∏—Å—Ç–µ–º—É.

### 1. üîß –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π

- –ü–æ–ª–Ω—ã–π –ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ **UUID**
- –ú–æ–¥–µ–ª–∏ **Document** –∏ **Chunk** —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω—ã —Å —Ä–µ–∞–ª—å–Ω–æ–π –±–∞–∑–æ–π
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ **pgvector(768)**
- –ü–æ–ª—è metadata –ø–µ—Ä–µ–≤–µ–¥–µ–Ω—ã –≤ **JSONB**

---

### 2. üì¶ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Alembic

- –°–æ–∑–¥–∞–Ω–∞ –ø–∞–ø–∫–∞ `alembic/`
- –ù–∞—Å—Ç—Ä–æ–µ–Ω—ã:

  - `env.py`
  - `script.py.mako`
  - `alembic.ini`

- –°–æ–∑–¥–∞–Ω–∞ –∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∞ –º–∏–≥—Ä–∞—Ü–∏—è **001_initial**

---

### 3. üóÑÔ∏è –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ë–î

- –°–∫—Ä–∏–ø—Ç `migrate.py` —Å–æ–∑–¥–∞–µ—Ç —Ç–∞–±–ª–∏—Ü—ã –Ω–∞–ø—Ä—è–º—É—é (–æ–±—Ö–æ–¥ –ø—Ä–æ–±–ª–µ–º Windows –∏ libpq)
- –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ **pgvector**
- –°–æ–∑–¥–∞–Ω—ã —Ç–∞–±–ª–∏—Ü—ã:

  - `documents`
  - `chunks`
  - `alembic_version`

- –°–æ–∑–¥–∞–Ω–æ **5 –∏–Ω–¥–µ–∫—Å–æ–≤**, –≤–∫–ª—é—á–∞—è:

  - **IVFFLAT** –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø–æ –≤–µ–∫—Ç–æ—Ä–∞–º

- –ù–∞—Å—Ç—Ä–æ–µ–Ω—ã **foreign keys —Å CASCADE DELETE**

---

### 4. üîç –ü—Ä–æ–≤–µ—Ä–∫–∞

`verify_db.py` –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç: –≤—Å—ë —Å–æ–±—Ä–∞–Ω–æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.

---

## üìö –°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### üìÑ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (5 —Ñ–∞–π–ª–æ–≤)

- **ALEMBIC_QUICK.md** ‚Äî –Ω–∞—á–Ω–∏—Ç–µ –æ—Ç—Å—é–¥–∞
- ALEMBIC_GUIDE.md ‚Äî –ø–æ–ª–Ω—ã–π –≥–∞–π–¥
- ALEMBIC_READY.md ‚Äî –ø–æ–¥—Ä–æ–±–Ω—ã–π —Å—Ç–∞—Ç—É—Å
- ALEMBIC_SUMMARY.md ‚Äî –∏—Ç–æ–≥–æ–≤–∞—è —Å–≤–æ–¥–∫–∞
- ALEMBIC_SETUP_COMPLETE.md ‚Äî —Ç–µ–∫—É—â–∏–π —Ñ–∞–π–ª –≤ –ø—Ä–æ–µ–∫—Ç–∞—Ö

---

### üõ† –£—Ç–∏–ª–∏—Ç—ã (–≤ `backend/`)

- `migrate.py` ‚Äî –ø—Ä—è–º–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π
- `verify_db.py` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ë–î

---

### üß¨ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Alembic (–≤ `backend/alembic/`)

- `env.py`
- `script.py.mako`
- `versions/001_initial.py`
- `../alembic.ini`

---

## üöÄ –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Alembic

### 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ë–î (–≤—ã–ø–æ–ª–Ω—è–π—Ç–µ –≤—Å–µ–≥–¥–∞ –ø–µ—Ä–≤—ã–º)

```bash
cd backend
uv run python verify_db.py
```

---

### 2. –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –º–∏–≥—Ä–∞—Ü–∏—é (–ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –º–æ–¥–µ–ª–µ–π)

```bash
uv run alembic revision --autogenerate -m "Add new field"
```

---

### 3. –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏

```bash
uv run alembic upgrade head
```

---

### 4. –û—Ç–∫–∞—Ç–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é

```bash
uv run alembic downgrade -1
```

---

### 5. –ï—Å–ª–∏ Alembic –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

```bash
uv run python migrate.py
```

---

## üí° –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- ‚úîÔ∏è –ú–æ–¥–µ–ª–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç **UUID**
- ‚úîÔ∏è –ü–æ–ª–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è **pgvector (768-dim)**
- ‚úîÔ∏è IVFFLAT –∏–Ω–¥–µ–∫—Å = –±—ã—Å—Ç—Ä—ã–π —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫
- ‚úîÔ∏è –ü–æ–ª–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è –º–∏–≥—Ä–∞—Ü–∏–π –≤ —Ç–∞–±–ª–∏—Ü–µ `alembic_version`
- ‚úîÔ∏è –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–∫–∞—Ç–∞ (`downgrade`)
- ‚úîÔ∏è `CASCADE DELETE` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è–µ—Ç chunks –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞

---

## üìñ –ü–æ–ª–µ–∑–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã

- –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç: **ALEMBIC_QUICK.md**
- –ü–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä –∫–æ–º–∞–Ω–¥: **ALEMBIC_COMMANDS.sh**
- –ü–æ–¥—Ä–æ–±–Ω—ã–π –≥–∞–π–¥: **ALEMBIC_GUIDE.md**

---

## üéâ –ò—Ç–æ–≥–æ–≤–∞—è —Å–≤–æ–¥–∫–∞

–Ø –ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–∞—Å—Ç—Ä–æ–∏–ª Alembic –¥–ª—è –≤–∞—à–µ–π RAG-—Å–∏—Å—Ç–µ–º—ã:

- –†–µ–∞–ª–∏–∑–æ–≤–∞–ª –º–∏–≥—Ä–∞—Ü–∏–∏ –¥–ª—è —Ä–µ–∞–ª—å–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö
- –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–ª PostgreSQL + pgvector
- –ù–∞—Å—Ç—Ä–æ–∏–ª –≤—Å–µ –∫–æ–Ω—Ñ–∏–≥–∏, –∏–Ω–¥–µ–∫—Å—ã, –∫–ª—é—á–∏
- –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–ª —Å–∏—Å—Ç–µ–º—É —á–µ—Ä–µ–∑ `verify_db.py`

–¢–µ–ø–µ—Ä—å –≤—Å—ë –≥–æ—Ç–æ–≤–æ:
**–º–æ–∂–Ω–æ —Ä–∞–∑–≤–∏–≤–∞—Ç—å –º–æ–¥–µ–ª–∏, —Å–æ–∑–¥–∞–≤–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ –∏ –æ–±–Ω–æ–≤–ª—è—Ç—å —Å—Ö–µ–º—É –±–µ–∑ –±–æ–ª–∏.**

---
